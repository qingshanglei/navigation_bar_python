# 导航栏管理页面（Element Plus）需求规范与实现提示词

更新时间：2025-08-09 04:18

---

## 一、项目背景与目标
- 背景：
  - 现有系统已完成登录、分类管理（/admin/categories）等基础能力，后续需要提供“导航栏管理”能力，以便对站点/应用的顶部导航或侧边导航进行结构化配置与运营。
  - 该页面在后台（Admin）中提供，供具备权限的管理员进行导航项（菜单项/链接项）的新增、编辑、删除、排序、分组、启用/禁用、公开/私有等操作。
- 目标：
  - 使用 Element Plus 实现现代化、可配置、可扩展的“导航栏管理”页面，支持树形视图与列表视图切换，满足多级菜单（建议最多 3 级）和可视化排序。
  - 保持与现有分类管理页面在视觉与交互上的一致性（风格、按钮、对话框、分页、响应式等）。
  - 先完成前端页面与交互原型（本次仅输出提示词与规范，不落代码），后续再分阶段联调后端 API。

## 二、术语定义
- 导航项（NavItem）：导航栏中的一个节点，可作为“目录（可展开）”或“链接（可点击跳转）”。
- 导航组（NavGroup）：可选的顶级分组概念，用于在复杂导航中对不同模块进行分组管理（可视化呈现为多个分段）。
- 可见性（Visibility）：公开/私有。公开对所有用户显示，私有仅对特定角色或登录用户显示（前端需配合权限控制标识）。
- 排序（Order）：同级之间的展示顺序，支持拖拽调整。

## 三、功能范围
1. 视图切换
   - 树形视图：展示层级结构，便于查看父子关系、配合分页、拖拽排序、折叠/展开。
   - 表格视图：平铺展示，配合分页、搜索、筛选、批量操作。

2. CRUD 操作
   - 新建导航项：支持选择父级（可为空=顶级）、类型（目录/链接）、名称、路径、图标、可见性、是否启用、打开方式（本页/新标签）、排序等。
   - 编辑导航项：支持除主键外的全部字段修改；编辑父级时需排除自身及其子孙，避免环。
   - 删除导航项：支持单个删除；若存在子节点，二次确认后可级联删除。

3. 排序与分组
   - 同级拖拽排序；支持批量上下移动、置顶/置底；提供“按字母/按创建时间/按手动排序”多种排序策略。
   - 可选：顶级“导航组”管理（新增/编辑/删除组，与导航项多对一）。

4. 状态与可见性
   - 可见性：公开/私有；支持条件筛选和批量修改。
   - 状态：启用/禁用；禁用项在前端不渲染或灰显处理。

5. 搜索与筛选
   - 关键字（名称、路径）搜索。
   - 过滤：可见性、启用状态、类型（目录/链接）、所属分组、创建时间范围、更新人等。

6. 批量操作
   - 批量删除、批量启用/禁用、批量设置可见性、批量移动到某父级/分组。

7. 细节交互
   - 表单校验（必填项、URL 校验、路径重复校验、父子环检测）。
   - 操作后保持当前视图与筛选条件，局部刷新。
   - 悬浮提示：超长名称/路径、图标预览。
   - 响应式与键盘可达性（可选）。

## 四、信息架构与数据模型（建议）
- NavItem 字段建议：
  - id: number/string
  - parent_id: number/string | null
  - type: 'directory' | 'link'
  - name: string
  - path: string | null   // 链接型必填，目录型可空
  - icon: string | null   // Element Plus/自定义图标名称
  - visible: boolean      // true=公开，false=私有
  - enabled: boolean      // true=启用，false=禁用
  - target: '_self' | '_blank'
  - order: number         // 排序值
  - group_id: number/string | null  // 所属导航组（可选）
  - created_at, updated_at, created_by, updated_by

- NavGroup 字段建议（如启用分组）：
  - id, name, order, enabled, created_at, updated_at

## 五、API 设计（待后端实现/联调，可先以 Mock 进行前端开发）
- 统一前缀建议：`/admin/nav`（与 `/admin/categories` 区分）。
- 接口列表（示例）：
  - GET `/admin/nav/items`：查询导航项列表（支持分页、筛选、排序）。
  - GET `/admin/nav/tree`：以树结构返回全部导航项（用于树形视图）。
  - GET `/admin/nav/items/{id}`：获取单个导航项详情。
  - POST `/admin/nav/items`：创建导航项。
  - PUT `/admin/nav/items/{id}`：更新导航项。
  - DELETE `/admin/nav/items/{id}`：删除导航项（级联删除可选通过 query 参数控制）。
  - PATCH `/admin/nav/items/batch`：批量启用/禁用/可见性/父级移动/排序等。
  - PUT `/admin/nav/items/reorder`：同级拖拽排序（提交新顺序数组）。
  - 可选：分组相关
    - GET `/admin/nav/groups`
    - POST `/admin/nav/groups`
    - PUT `/admin/nav/groups/{id}`
    - DELETE `/admin/nav/groups/{id}`
- 认证与安全：
  - 复用现有 JWT 体系；所有接口受保护；CORS 延用现有配置。
  - 后端需做父子环校验、路径唯一性、权限控制与审计日志。

## 六、页面与组件设计（Element Plus）
1. 顶部工具条
   - 视图切换（树形/列表）
   - 搜索框（名称/路径）
   - 筛选器（可见性、状态、类型、分组）
   - 新建按钮、批量操作下拉

2. 树形视图
   - 使用 `el-tree` + `draggable`（或自定义拖拽）
   - 节点操作：新增子项、编辑、删除、启用/禁用、可见性切换
   - 展开/收起、按组分段显示（若启用分组）

3. 列表视图
   - 使用 `el-table` + 分页 `el-pagination`
   - 列：名称（含图标）、类型、路径、可见性、状态、分组、排序值、更新时间、操作
   - 支持列宽拖拽、列显隐（可选）

4. 表单对话框（新增/编辑）
   - 基本项：名称、类型（目录/链接）、父级选择（级联选择器，编辑时排除自身及子孙）、路径（链接型必填且唯一）、图标选择器、可见性、状态、目标窗口、排序、分组
   - 校验：
     - 名称：必填、长度限制（1-50）
     - 路径：链接型必填、URL 或内部路由校验、唯一性校验
     - 父级：不可选择自身及其子孙
     - 排序：整数、范围（如 0-9999）

5. 交互与反馈
   - 所有操作均需成功/失败提示；删除需二次确认；级联删除提示包含子项数量。
   - 操作后根据当前视图（树/表）进行最小化刷新以保持上下文。

6. 响应式与可访问性
   - 移动端/小屏适配：工具条折叠、表格列精简。
   - 键盘导航与 ARIA 标签（可选）。

## 七、状态管理与数据流
- 建议：`pinia` 或轻量自管（若当前项目未集成 Vue 架构，可用模块化 JS 管理状态）。
- 缓存策略：树数据在切换到树形视图后短期缓存；任何变更操作均需同步失效或局部更新。
- 错误处理：统一 Toast + 控制台日志；接口返回结构与分类管理保持一致（code/msg/data）。

## 八、权限与可见性策略
- 前端：根据 `visible` 与 `enabled` 字段控制渲染/灰显；敏感操作按钮按权限隐藏或禁用。
- 后端：基于角色的访问控制（RBAC），仅管理员可写；审计记录操作人和时间。

## 九、性能与体验
- 懒加载：树形结构在展开时按需加载子节点（可选）。
- 批量操作：后端提供批处理接口减少请求次数。
- 拖拽排序：节流处理与乐观更新；失败回滚。

## 十、测试与验收标准
- 单元测试：表单校验函数、树形环检测、排序转换逻辑。
- 集成测试：
  - 树/表视图切换正常，状态持久。
  - 新增/编辑/删除后数据一致；编辑父级不产生环；路径唯一性生效。
  - 拖拽排序提交正确顺序；批量操作正确生效。
- 回归测试：不影响现有分类管理页面与登录系统。
- 验收标准：
  - 所有列举的核心功能在桌面与移动端表现正常。
  - 操作提示准确、接口错误能被识别并友好提示。

## 十一、实现步骤（建议迭代）
1. 低保真原型与组件骨架（仅前端静态结构与交互流转）。
2. 接入 Mock 数据，完成树/表视图、表单校验、拖拽排序的前端逻辑闭环。
3. 后端接口设计与实现（/admin/nav 前缀），对齐统一响应格式与鉴权机制。
4. 前后端联调（含批量操作、级联删除、唯一性与环校验）。
5. 完成响应式与可访问性优化、错误与边界处理。
6. 补充测试与文档，准备上线。

## 十二、UI 风格与一致性
- 复用现有后台的渐变背景、毛玻璃、按钮与对话框风格；图标风格统一。
- 表格、分页、筛选面板与分类管理保持一致体验。

## 十三、风险与对策
- 风险：父子环与跨层级拖拽导致的数据不一致。
  - 对策：前端预校验 + 后端强校验；拖拽落点合法性判断。
- 风险：路径唯一性与外链安全。
  - 对策：新增/编辑时即时唯一性校验；对外链加 rel="noopener"，可选白名单。
- 风险：批量操作误操作。
  - 对策：二次确认、操作可撤销（可选）、操作日志记录。

## 十四、交互文案（示例）
- “确定删除该导航项？该操作不可恢复”
- “检测到该项含有 {n} 个子项，是否级联删除？”
- “路径已存在，请更换”
- “不允许将节点移动到其自身或子孙节点下”

## 十五、对接与对齐
- 与现有分类管理接口风格、鉴权、响应结构保持一致。
- 所有前端资源路径使用相对路径；避免与现有文件/样式冲突。

---

以上为“导航栏管理页面（Element Plus）”的详细提示词与实施规范。本次仅提交文档，不提交代码。后续如确认无误，将按“实现步骤”推进开发与联调。
